var Ye=Object.defineProperty;var qe=(e,t,n)=>t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var h=(e,t,n)=>(qe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var X=function(e,t){return X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},X(e,t)};function A(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");X(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Qe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(f){try{c(r.next(f))}catch(d){a(d)}}function u(f){try{c(r.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):o(f.value).then(s,u)}c((r=r.apply(e,t||[])).next())})}function ge(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(f){return u([c,f])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(r=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(f){c=[6,f],o=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function _(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i}function T(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function O(e){return this instanceof O?(this.v=e,this):new O(e)}function Ke(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),o,i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(l){r[l]&&(o[l]=function(y){return new Promise(function(w,b){i.push([l,y,w,b])>1||s(l,y)})})}function s(l,y){try{u(r[l](y))}catch(w){d(i[0][3],w)}}function u(l){l.value instanceof O?Promise.resolve(l.value.v).then(c,f):d(i[0][2],l)}function c(l){s("next",l)}function f(l){s("throw",l)}function d(l,y){l(y),i.shift(),i.length&&s(i[0][0],i[0][1])}}function Je(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof _=="function"?_(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(a){return new Promise(function(s,u){a=e[i](a),o(s,u,a.done,a.value)})}}function o(i,a,s,u){Promise.resolve(u).then(function(c){i({value:c,done:s})},a)}}function m(e){return typeof e=="function"}function we(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var H=we(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,o){return o+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Z(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Y=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,o,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=_(a),u=s.next();!u.done;u=s.next()){var c=u.value;c.remove(this)}}catch(b){t={error:b}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}else a.remove(this);var f=this.initialTeardown;if(m(f))try{f()}catch(b){i=b instanceof H?b.errors:[b]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var l=_(d),y=l.next();!y.done;y=l.next()){var w=y.value;try{de(w)}catch(b){i=i??[],b instanceof H?i=T(T([],C(i)),C(b.errors)):i.push(b)}}}catch(b){r={error:b}}finally{try{y&&!y.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}if(i)throw new H(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)de(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&Z(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&Z(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Se=Y.EMPTY;function Oe(e){return e instanceof Y||e&&"closed"in e&&m(e.remove)&&m(e.add)&&m(e.unsubscribe)}function de(e){m(e)?e():e.unsubscribe()}var Ee={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},N={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=N.delegate;return o!=null&&o.setTimeout?o.setTimeout.apply(o,T([e,t],C(n))):setTimeout.apply(void 0,T([e,t],C(n)))},clearTimeout:function(e){var t=N.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function _e(e){N.setTimeout(function(){throw e})}function he(){}function F(e){e()}var te=function(e){A(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Oe(n)&&n.add(r)):r.destination=Xe,r}return t.create=function(n,r,o){return new ee(n,r,o)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Y),He=Function.prototype.bind;function z(e,t){return He.call(e,t)}var ze=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){M(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){M(r)}else M(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){M(n)}},e}(),ee=function(e){A(t,e);function t(n,r,o){var i=e.call(this)||this,a;if(m(n)||!n)a={next:n??void 0,error:r??void 0,complete:o??void 0};else{var s;i&&Ee.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return i.unsubscribe()},a={next:n.next&&z(n.next,s),error:n.error&&z(n.error,s),complete:n.complete&&z(n.complete,s)}):a=n}return i.destination=new ze(a),i}return t}(te);function M(e){_e(e)}function We(e){throw e}var Xe={closed:!0,next:he,error:We,complete:he},ne=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function q(e){return e}function Ze(e){return e.length===0?q:e.length===1?e[0]:function(n){return e.reduce(function(r,o){return o(r)},n)}}var g=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var o=this,i=et(t)?t:new ee(t,n,r);return F(function(){var a=o,s=a.operator,u=a.source;i.add(s?s.call(i,u):u?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=pe(n),new n(function(o,i){var a=new ee({next:function(s){try{t(s)}catch(u){i(u),a.unsubscribe()}},error:i,complete:o});r.subscribe(a)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ne]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Ze(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=pe(t),new t(function(r,o){var i;n.subscribe(function(a){return i=a},function(a){return o(a)},function(){return r(i)})})},e.create=function(t){return new e(t)},e}();function pe(e){var t;return(t=e??Ee.Promise)!==null&&t!==void 0?t:Promise}function Ne(e){return e&&m(e.next)&&m(e.error)&&m(e.complete)}function et(e){return e&&e instanceof te||Ne(e)&&Oe(e)}function tt(e){return m(e==null?void 0:e.lift)}function j(e){return function(t){if(tt(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function k(e,t,n,r,o){return new nt(e,t,n,r,o)}var nt=function(e){A(t,e);function t(n,r,o,i,a,s){var u=e.call(this,n)||this;return u.onFinalize=a,u.shouldUnsubscribe=s,u._next=r?function(c){try{r(c)}catch(f){n.error(f)}}:e.prototype._next,u._error=i?function(c){try{i(c)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=o?function(){try{o()}catch(c){n.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,u}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(te),rt=we(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),re=function(e){A(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new ve(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new rt},t.prototype.next=function(n){var r=this;F(function(){var o,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=_(r.currentObservers),s=a.next();!s.done;s=a.next()){var u=s.value;u.next(n)}}catch(c){o={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}})},t.prototype.error=function(n){var r=this;F(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var o=r.observers;o.length;)o.shift().error(n)}})},t.prototype.complete=function(){var n=this;F(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,o=this,i=o.hasError,a=o.isStopped,s=o.observers;return i||a?Se:(this.currentObservers=null,s.push(n),new Y(function(){r.currentObservers=null,Z(s,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,o=r.hasError,i=r.thrownError,a=r.isStopped;o?n.error(i):a&&n.complete()},t.prototype.asObservable=function(){var n=new g;return n.source=this,n},t.create=function(n,r){return new ve(n,r)},t}(g),ve=function(e){A(t,e);function t(n,r){var o=e.call(this)||this;return o.destination=n,o.source=r,o}return t.prototype.next=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,n)},t.prototype.error=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&o!==void 0?o:Se},t}(re),ot=function(e){A(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,o=n.thrownError,i=n._value;if(r)throw o;return this._throwIfClosed(),i},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(re);function it(e){return e&&m(e.schedule)}function Ae(e){return e[e.length-1]}function at(e){return m(Ae(e))?e.pop():void 0}function ct(e){return it(Ae(e))?e.pop():void 0}var Ge=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Ie(e){return m(e==null?void 0:e.then)}function Pe(e){return m(e[ne])}function xe(e){return Symbol.asyncIterator&&m(e==null?void 0:e[Symbol.asyncIterator])}function Ce(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function st(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Te=st();function je(e){return m(e==null?void 0:e[Te])}function ke(e){return Ke(this,arguments,function(){var n,r,o,i;return ge(this,function(a){switch(a.label){case 0:n=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,O(n.read())];case 3:return r=a.sent(),o=r.value,i=r.done,i?[4,O(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,O(o)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Re(e){return m(e==null?void 0:e.getReader)}function oe(e){if(e instanceof g)return e;if(e!=null){if(Pe(e))return ut(e);if(Ge(e))return lt(e);if(Ie(e))return ft(e);if(xe(e))return Be(e);if(je(e))return dt(e);if(Re(e))return ht(e)}throw Ce(e)}function ut(e){return new g(function(t){var n=e[ne]();if(m(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lt(e){return new g(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function ft(e){return new g(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,_e)})}function dt(e){return new g(function(t){var n,r;try{for(var o=_(e),i=o.next();!i.done;i=o.next()){var a=i.value;if(t.next(a),t.closed)return}}catch(s){n={error:s}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t.complete()})}function Be(e){return new g(function(t){pt(e,t).catch(function(n){return t.error(n)})})}function ht(e){return Be(ke(e))}function pt(e,t){var n,r,o,i;return Qe(this,void 0,void 0,function(){var a,s;return ge(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=Je(e),u.label=1;case 1:return[4,n.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=u.sent(),o={error:s},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function S(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function De(e,t){return t===void 0&&(t=0),j(function(n,r){n.subscribe(k(r,function(o){return S(r,e,function(){return r.next(o)},t)},function(){return S(r,e,function(){return r.complete()},t)},function(o){return S(r,e,function(){return r.error(o)},t)}))})}function Ue(e,t){return t===void 0&&(t=0),j(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function vt(e,t){return oe(e).pipe(Ue(t),De(t))}function yt(e,t){return oe(e).pipe(Ue(t),De(t))}function mt(e,t){return new g(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function bt(e,t){return new g(function(n){var r;return S(n,t,function(){r=e[Te](),S(n,t,function(){var o,i,a;try{o=r.next(),i=o.value,a=o.done}catch(s){n.error(s);return}a?n.complete():n.next(i)},0,!0)}),function(){return m(r==null?void 0:r.return)&&r.return()}})}function Le(e,t){if(!e)throw new Error("Iterable cannot be null");return new g(function(n){S(n,t,function(){var r=e[Symbol.asyncIterator]();S(n,t,function(){r.next().then(function(o){o.done?n.complete():n.next(o.value)})},0,!0)})})}function gt(e,t){return Le(ke(e),t)}function wt(e,t){if(e!=null){if(Pe(e))return vt(e,t);if(Ge(e))return mt(e,t);if(Ie(e))return yt(e,t);if(xe(e))return Le(e,t);if(je(e))return bt(e,t);if(Re(e))return gt(e,t)}throw Ce(e)}function $e(e,t){return t?wt(e,t):oe(e)}function ie(e,t){return j(function(n,r){var o=0;n.subscribe(k(r,function(i){r.next(e.call(t,i,o++))}))})}var St=Array.isArray;function Ot(e,t){return St(t)?e.apply(void 0,T([],C(t))):e(t)}function Et(e){return ie(function(t){return Ot(e,t)})}var _t=Array.isArray,At=Object.getPrototypeOf,Gt=Object.prototype,It=Object.keys;function Pt(e){if(e.length===1){var t=e[0];if(_t(t))return{args:t,keys:null};if(xt(t)){var n=It(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function xt(e){return e&&typeof e=="object"&&At(e)===Gt}function Ct(e,t){return e.reduce(function(n,r,o){return n[r]=t[o],n},{})}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ct(e),r=at(e),o=Pt(e),i=o.args,a=o.keys;if(i.length===0)return $e([],n);var s=new g(jt(i,n,a?function(u){return Ct(a,u)}:q));return r?s.pipe(Et(r)):s}function jt(e,t,n){return n===void 0&&(n=q),function(r){ye(t,function(){for(var o=e.length,i=new Array(o),a=o,s=o,u=function(f){ye(t,function(){var d=$e(e[f],t),l=!1;d.subscribe(k(r,function(y){i[f]=y,l||(l=!0,s--),s||r.next(n(i.slice()))},function(){--a||r.complete()}))},r)},c=0;c<o;c++)u(c)},r)}}function ye(e,t,n){e?S(n,e,t):t()}function R(e,t){return j(function(n,r){var o=0;n.subscribe(k(r,function(i){return e.call(t,i,o++)&&r.next(i)}))})}function ae(e,t){return t===void 0&&(t=q),e=e??kt,j(function(n,r){var o,i=!0;n.subscribe(k(r,function(a){var s=t(a);(i||!e(o,s))&&(i=!1,o=s,r.next(a))}))})}function kt(e,t){return e===t}const le=class{constructor(){h(this,"map",new Map);h(this,"_events",new re);h(this,"events$",this._events.asObservable());h(this,"name",crypto.randomUUID())}static incSeq(){this._SEQ++}static get SEQ(){return this._SEQ}on(t,n){this.map.set(t,n)}log(...t){console.log(`${le.SEQ}.`,...t)}};let E=le;h(E,"_SEQ",0);class Rt extends E{constructor(){super();h(this,"provider",new WebSocket("wss://gateway.p2p.works"));console.log(this.provider),this.provider.onopen=n=>console.log(n),this.provider.onmessage=({data:n})=>{if(n){const{type:r,name:o,payload:i}=JSON.parse(n)??{};if(r&&o!==this.name){const a=this.map.get(r);a&&this._events.next(new a(i))}}}}onOpen(n){this.provider.onopen=n}emit(n,r){const o={payload:r,name:this.name,type:n};this.provider.readyState===this.provider.OPEN&&this.provider.send(JSON.stringify(o))}}class ce extends RTCSessionDescription{constructor(t){super(t)}}class se extends RTCIceCandidate{constructor(t){super(t)}}const Me=new Map;function Bt(e,t){Me.set(e,t)}function Dt(e){const t=Me.get(e);if(!t)throw new Error(`O tipo ${e.name} não está registrado`);return new t}class Q extends RTCSessionDescription{constructor(t){super(t)}}const Ut=e=>{const t=new ot(e),n=()=>t.getValue();return{value$:t.asObservable(),select:u=>t.asObservable().pipe(ie(c=>u(c)),ae()),value:n,patch:u=>{t.next({...n(),...u})},update:(u,c)=>{t.next({...n(),[u]:c})},set:u=>t.next(u)}},Lt=["have-remote-offer","have-local-pranswer"],$t=e=>Lt.includes(e),Mt=async(e,t)=>{const n=await e.createAnswer(t);return await e.setLocalDescription(n),n},Fe=()=>{const e=document.createElement("audio");return e.controls=!0,e.autoplay=!0,e},Ve=async(e,t)=>{const n=await e.createOffer(t);return await e.setLocalDescription(n),n};function ue(...e){const t=n=>!!e.find(r=>n instanceof r);return n=>n.pipe(R(t))}function me(e,t,n,r){const o=t*e.sampleRate,i=(t-2*n)*e.sampleRate,a=o+i,s=e.createBuffer(1,a,e.sampleRate),u=s.getChannelData(0);for(let c=0;c<o;++c)r?u[c]=(o-c)/a:u[c]=c/o;for(let c=o;c<a;++c)u[c]=0;return s}function Ft(e,t,n){const r=t*e.sampleRate,o=(t-2*n)*e.sampleRate,i=r+o,a=e.createBuffer(1,i,e.sampleRate),s=a.getChannelData(0),u=n*e.sampleRate,c=u,f=r-u;for(let d=0;d<r;++d){let l;d<c?l=Math.sqrt(d/u):d>=f?l=Math.sqrt(1-(d-f)/u):l=1,s[d]=l}for(let d=r;d<i;++d)s[d]=0;return a}class Vt{constructor(t,n=.1,r=.05,o=.1){h(this,"input");h(this,"output");h(this,"shiftDownBuffer");h(this,"shiftUpBuffer");h(this,"mod1");h(this,"mod2");h(this,"mod1Gain");h(this,"mod2Gain");h(this,"mod3Gain");h(this,"mod4Gain");h(this,"modGain1");h(this,"modGain2");h(this,"fade1");h(this,"fade2");h(this,"mix1");h(this,"mix2");h(this,"delay1");h(this,"delay2");this.context=t,this.bufferTime=n,this.fadeTime=r,this.delayTime=o;const i=t.createGain(),a=t.createGain();this.input=i,this.output=a;const s=t.createBufferSource(),u=t.createBufferSource(),c=t.createBufferSource(),f=t.createBufferSource();this.shiftDownBuffer=me(t,n,r,!1),this.shiftUpBuffer=me(t,n,r,!0),s.buffer=this.shiftDownBuffer,u.buffer=this.shiftDownBuffer,c.buffer=this.shiftUpBuffer,f.buffer=this.shiftUpBuffer,s.loop=!0,u.loop=!0,c.loop=!0,f.loop=!0;const d=t.createGain(),l=t.createGain(),y=t.createGain();y.gain.value=0;const w=t.createGain();w.gain.value=0,s.connect(d),u.connect(l),c.connect(y),f.connect(w);const b=t.createGain(),D=t.createGain(),U=t.createDelay(),L=t.createDelay();d.connect(b),l.connect(D),y.connect(b),w.connect(D),b.connect(U.delayTime),D.connect(L.delayTime);const G=t.createBufferSource(),I=t.createBufferSource(),fe=Ft(t,n,r);G.buffer=fe,I.buffer=fe,G.loop=!0,I.loop=!0;const P=t.createGain(),x=t.createGain();P.gain.value=0,x.gain.value=0,G.connect(P.gain),I.connect(x.gain),i.connect(U),i.connect(L),U.connect(P),L.connect(x),P.connect(a),x.connect(a);const $=t.currentTime+.05,J=$+n-r;s.start($),u.start(J),c.start($),f.start(J),G.start($),I.start(J),this.mod1=s,this.mod2=u,this.mod1Gain=d,this.mod2Gain=l,this.mod3Gain=y,this.mod4Gain=w,this.modGain1=b,this.modGain2=D,this.fade1=G,this.fade2=I,this.mix1=P,this.mix2=x,this.delay1=U,this.delay2=L,this.setDelay(o)}setDelay(t){this.modGain1.gain.setTargetAtTime(.5*t,0,.01),this.modGain2.gain.setTargetAtTime(.5*t,0,.01)}setPitchOffset(t){t>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(this.delayTime*Math.abs(t))}}const Yt=e=>{const t=new AudioContext,n=t.createMediaStreamSource(e),r=t.createDelay();r.delayTime.value=0,n.connect(r);const o=new Vt(t);o.setPitchOffset(1.6),r.connect(o.input),o.output.connect(t.destination);const i=document.createElement("input");return i.type="range",i.min="-2",i.max="2",i.oninput=()=>{o.setPitchOffset(i.valueAsNumber)},i};Bt(E,Rt);const p=Dt(E);p.on("offer",Q);p.on("answer",ce);p.on("candidate",se);const be=new MediaStream,V=Fe(),W=Fe(),v=new RTCPeerConnection;v.onicecandidate=e=>{if(e.candidate){const t=new se(e.candidate);p.emit("candidate",t),p.log("Enviei meus candidatos")}};const B=Ut({signaling:"closed",connection:"new",iceConnection:"closed",iceGathering:"new"});v.onsignalingstatechange=()=>{B.update("signaling",v.signalingState)};v.oniceconnectionstatechange=()=>{B.update("iceConnection",v.iceConnectionState)};v.onconnectionstatechange=()=>{B.update("connection",v.connectionState)};v.onicegatheringstatechange=()=>{B.update("iceGathering",v.iceGatheringState)};p.events$.pipe(ue(Q),ie(async e=>(p.log("Recebi uma oferta"),await v.setRemoteDescription(e),p.log("Configurei uma descrição remota"),e))).subscribe(async e=>{if(await e,$t(v.signalingState)){p.log("Aceitei uma oferta");const t=await Mt(v);p.log("Configurei uma descrição local"),p.emit("answer",new ce(t)),p.log("Enviei uma resposta")}});p.events$.pipe(ue(ce)).subscribe(async e=>{p.log("Recebi uma resposta"),v.setRemoteDescription(e),p.log("Configurei uma descrição remota")});p.events$.pipe(ue(se)).subscribe(async e=>{v.remoteDescription&&await v.addIceCandidate(e)});v.onnegotiationneeded=async()=>{p.log("Vamos negociar"),p.onOpen(async()=>{const e=await Ve(v);p.emit("offer",new Q(e)),p.log("Enviei uma oferta")})};const K=B.select(e=>e.connection),qt=K.pipe(R(e=>e==="connected")),Qt=K.pipe(R(e=>e==="disconnected"),ae((e,t)=>e!=="disconnected"&&t==="connecting")),Kt=K.pipe(R(e=>e==="disconnected"),ae((e,t)=>e!=="disconnected"&&t==="disconnected")),Jt=K.pipe(R(e=>e==="disconnected"));qt.subscribe(()=>{document.body.appendChild(V)});Jt.subscribe(()=>{V.remove()});Tt([Kt,Qt]).subscribe(async()=>{const e=await Ve(v);p.emit("offer",new Q(e)),p.log("Fomos desconectados, enviei uma nova oferta")});v.ontrack=({track:e})=>{e&&(be.addTrack(e),V.srcObject=be,V.autoplay=!0)};navigator.mediaDevices.getUserMedia({audio:!0}).then(async e=>{const[t]=e.getAudioTracks();W.srcObject=e,W.muted=!0,v.addTrack(t),document.body.appendChild(W),document.body.appendChild(Yt(e))});
