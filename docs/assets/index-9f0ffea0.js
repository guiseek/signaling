var Ve=Object.defineProperty;var Ye=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var h=(e,t,n)=>(Ye(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var N=function(e,t){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},N(e,t)};function T(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");N(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Qe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function c(f){try{s(r.next(f))}catch(d){a(d)}}function u(f){try{s(r.throw(f))}catch(d){a(d)}}function s(f){f.done?i(f.value):o(f.value).then(c,u)}s((r=r.apply(e,t||[])).next())})}function ge(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(s){return function(f){return u([s,f])}}function u(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(n=0)),n;)try{if(r=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,o=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){n.label=s[1];break}if(s[0]===6&&n.label<i[1]){n.label=i[1],i=s;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(s);break}i[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(f){s=[6,f],o=0}finally{r=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function C(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i}function D(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function G(e){return this instanceof G?(this.v=e,this):new G(e)}function Ke(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),o,i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(l){r[l]&&(o[l]=function(p){return new Promise(function(g,y){i.push([l,p,g,y])>1||c(l,p)})})}function c(l,p){try{u(r[l](p))}catch(g){d(i[0][3],g)}}function u(l){l.value instanceof G?Promise.resolve(l.value.v).then(s,f):d(i[0][2],l)}function s(l){c("next",l)}function f(l){c("throw",l)}function d(l,p){l(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}function He(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof C=="function"?C(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(a){return new Promise(function(c,u){a=e[i](a),o(c,u,a.done,a.value)})}}function o(i,a,c,u){Promise.resolve(u).then(function(s){i({value:s,done:c})},a)}}function b(e){return typeof e=="function"}function we(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var W=we(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,o){return o+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function ee(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Y=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,o,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=C(a),u=c.next();!u.done;u=c.next()){var s=u.value;s.remove(this)}}catch(y){t={error:y}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else a.remove(this);var f=this.initialTeardown;if(b(f))try{f()}catch(y){i=y instanceof W?y.errors:[y]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var l=C(d),p=l.next();!p.done;p=l.next()){var g=p.value;try{he(g)}catch(y){i=i??[],y instanceof W?i=D(D([],B(i)),B(y.errors)):i.push(y)}}}catch(y){r={error:y}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}if(i)throw new W(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)he(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&ee(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&ee(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Se=Y.EMPTY;function Oe(e){return e instanceof Y||e&&"closed"in e&&b(e.remove)&&b(e.add)&&b(e.unsubscribe)}function he(e){b(e)?e():e.unsubscribe()}var Ae={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},te={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=te.delegate;return o!=null&&o.setTimeout?o.setTimeout.apply(o,D([e,t],B(n))):setTimeout.apply(void 0,D([e,t],B(n)))},clearTimeout:function(e){var t=te.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Ee(e){te.setTimeout(function(){throw e})}function pe(){}function q(e){e()}var re=function(e){T(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Oe(n)&&n.add(r)):r.destination=Xe,r}return t.create=function(n,r,o){return new ne(n,r,o)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Y),Je=Function.prototype.bind;function z(e,t){return Je.call(e,t)}var We=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){M(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){M(r)}else M(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){M(n)}},e}(),ne=function(e){T(t,e);function t(n,r,o){var i=e.call(this)||this,a;if(b(n)||!n)a={next:n??void 0,error:r??void 0,complete:o??void 0};else{var c;i&&Ae.useDeprecatedNextContext?(c=Object.create(n),c.unsubscribe=function(){return i.unsubscribe()},a={next:n.next&&z(n.next,c),error:n.error&&z(n.error,c),complete:n.complete&&z(n.complete,c)}):a=n}return i.destination=new We(a),i}return t}(re);function M(e){Ee(e)}function ze(e){throw e}var Xe={closed:!0,next:pe,error:ze,complete:pe},oe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Q(e){return e}function Ze(e){return e.length===0?Q:e.length===1?e[0]:function(n){return e.reduce(function(r,o){return o(r)},n)}}var S=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var o=this,i=et(t)?t:new ne(t,n,r);return q(function(){var a=o,c=a.operator,u=a.source;i.add(c?c.call(i,u):u?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=ve(n),new n(function(o,i){var a=new ne({next:function(c){try{t(c)}catch(u){i(u),a.unsubscribe()}},error:i,complete:o});r.subscribe(a)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[oe]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Ze(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=ve(t),new t(function(r,o){var i;n.subscribe(function(a){return i=a},function(a){return o(a)},function(){return r(i)})})},e.create=function(t){return new e(t)},e}();function ve(e){var t;return(t=e??Ae.Promise)!==null&&t!==void 0?t:Promise}function Ne(e){return e&&b(e.next)&&b(e.error)&&b(e.complete)}function et(e){return e&&e instanceof re||Ne(e)&&Oe(e)}function tt(e){return b(e==null?void 0:e.lift)}function j(e){return function(t){if(tt(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function U(e,t,n,r,o){return new nt(e,t,n,r,o)}var nt=function(e){T(t,e);function t(n,r,o,i,a,c){var u=e.call(this,n)||this;return u.onFinalize=a,u.shouldUnsubscribe=c,u._next=r?function(s){try{r(s)}catch(f){n.error(f)}}:e.prototype._next,u._error=i?function(s){try{i(s)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=o?function(){try{o()}catch(s){n.error(s)}finally{this.unsubscribe()}}:e.prototype._complete,u}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(re),rt=we(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ie=function(e){T(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new ye(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new rt},t.prototype.next=function(n){var r=this;q(function(){var o,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=C(r.currentObservers),c=a.next();!c.done;c=a.next()){var u=c.value;u.next(n)}}catch(s){o={error:s}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}})},t.prototype.error=function(n){var r=this;q(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var o=r.observers;o.length;)o.shift().error(n)}})},t.prototype.complete=function(){var n=this;q(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,o=this,i=o.hasError,a=o.isStopped,c=o.observers;return i||a?Se:(this.currentObservers=null,c.push(n),new Y(function(){r.currentObservers=null,ee(c,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,o=r.hasError,i=r.thrownError,a=r.isStopped;o?n.error(i):a&&n.complete()},t.prototype.asObservable=function(){var n=new S;return n.source=this,n},t.create=function(n,r){return new ye(n,r)},t}(S),ye=function(e){T(t,e);function t(n,r){var o=e.call(this)||this;return o.destination=n,o.source=r,o}return t.prototype.next=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,n)},t.prototype.error=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&o!==void 0?o:Se},t}(ie),ot=function(e){T(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,o=n.thrownError,i=n._value;if(r)throw o;return this._throwIfClosed(),i},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(ie);function it(e){return e&&b(e.schedule)}function _e(e){return e[e.length-1]}function at(e){return b(_e(e))?e.pop():void 0}function ct(e){return it(_e(e))?e.pop():void 0}var Ie=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Ge(e){return b(e==null?void 0:e.then)}function xe(e){return b(e[oe])}function Pe(e){return Symbol.asyncIterator&&b(e==null?void 0:e[Symbol.asyncIterator])}function Ce(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function st(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Te=st();function ke(e){return b(e==null?void 0:e[Te])}function Re(e){return Ke(this,arguments,function(){var n,r,o,i;return ge(this,function(a){switch(a.label){case 0:n=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,G(n.read())];case 3:return r=a.sent(),o=r.value,i=r.done,i?[4,G(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,G(o)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Be(e){return b(e==null?void 0:e.getReader)}function ae(e){if(e instanceof S)return e;if(e!=null){if(xe(e))return ut(e);if(Ie(e))return lt(e);if(Ge(e))return ft(e);if(Pe(e))return De(e);if(ke(e))return dt(e);if(Be(e))return ht(e)}throw Ce(e)}function ut(e){return new S(function(t){var n=e[oe]();if(b(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lt(e){return new S(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function ft(e){return new S(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Ee)})}function dt(e){return new S(function(t){var n,r;try{for(var o=C(e),i=o.next();!i.done;i=o.next()){var a=i.value;if(t.next(a),t.closed)return}}catch(c){n={error:c}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t.complete()})}function De(e){return new S(function(t){pt(e,t).catch(function(n){return t.error(n)})})}function ht(e){return De(Re(e))}function pt(e,t){var n,r,o,i;return Qe(this,void 0,void 0,function(){var a,c;return ge(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=He(e),u.label=1;case 1:return[4,n.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),o={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function A(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function je(e,t){return t===void 0&&(t=0),j(function(n,r){n.subscribe(U(r,function(o){return A(r,e,function(){return r.next(o)},t)},function(){return A(r,e,function(){return r.complete()},t)},function(o){return A(r,e,function(){return r.error(o)},t)}))})}function Ue(e,t){return t===void 0&&(t=0),j(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function vt(e,t){return ae(e).pipe(Ue(t),je(t))}function yt(e,t){return ae(e).pipe(Ue(t),je(t))}function mt(e,t){return new S(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function bt(e,t){return new S(function(n){var r;return A(n,t,function(){r=e[Te](),A(n,t,function(){var o,i,a;try{o=r.next(),i=o.value,a=o.done}catch(c){n.error(c);return}a?n.complete():n.next(i)},0,!0)}),function(){return b(r==null?void 0:r.return)&&r.return()}})}function Le(e,t){if(!e)throw new Error("Iterable cannot be null");return new S(function(n){A(n,t,function(){var r=e[Symbol.asyncIterator]();A(n,t,function(){r.next().then(function(o){o.done?n.complete():n.next(o.value)})},0,!0)})})}function gt(e,t){return Le(Re(e),t)}function wt(e,t){if(e!=null){if(xe(e))return vt(e,t);if(Ie(e))return mt(e,t);if(Ge(e))return yt(e,t);if(Pe(e))return Le(e,t);if(ke(e))return bt(e,t);if(Be(e))return gt(e,t)}throw Ce(e)}function $e(e,t){return t?wt(e,t):ae(e)}function ce(e,t){return j(function(n,r){var o=0;n.subscribe(U(r,function(i){r.next(e.call(t,i,o++))}))})}var St=Array.isArray;function Ot(e,t){return St(t)?e.apply(void 0,D([],B(t))):e(t)}function At(e){return ce(function(t){return Ot(e,t)})}var Et=Array.isArray,_t=Object.getPrototypeOf,It=Object.prototype,Gt=Object.keys;function xt(e){if(e.length===1){var t=e[0];if(Et(t))return{args:t,keys:null};if(Pt(t)){var n=Gt(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function Pt(e){return e&&typeof e=="object"&&_t(e)===It}function Ct(e,t){return e.reduce(function(n,r,o){return n[r]=t[o],n},{})}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ct(e),r=at(e),o=xt(e),i=o.args,a=o.keys;if(i.length===0)return $e([],n);var c=new S(kt(i,n,a?function(u){return Ct(a,u)}:Q));return r?c.pipe(At(r)):c}function kt(e,t,n){return n===void 0&&(n=Q),function(r){me(t,function(){for(var o=e.length,i=new Array(o),a=o,c=o,u=function(f){me(t,function(){var d=$e(e[f],t),l=!1;d.subscribe(U(r,function(p){i[f]=p,l||(l=!0,c--),c||r.next(n(i.slice()))},function(){--a||r.complete()}))},r)},s=0;s<o;s++)u(s)},r)}}function me(e,t,n){e?A(n,e,t):t()}function L(e,t){return j(function(n,r){var o=0;n.subscribe(U(r,function(i){return e.call(t,i,o++)&&r.next(i)}))})}function se(e,t){return t===void 0&&(t=Q),e=e??Rt,j(function(n,r){var o,i=!0;n.subscribe(U(r,function(a){var c=t(a);(i||!e(o,c))&&(i=!1,o=c,r.next(a))}))})}function Rt(e,t){return e===t}const V=class{constructor(){h(this,"map",new Map);h(this,"_events",new ie);h(this,"events$",this._events.asObservable());h(this,"name",crypto.randomUUID())}static incSeq(){this._SEQ++}static get SEQ(){return this._SEQ}on(t,n){this.map.set(t,n)}log(...t){V.incSeq(),console.log(`${V.SEQ}.`,...t)}};let x=V;h(x,"_SEQ",0);class Bt extends x{constructor(){super();h(this,"provider",new WebSocket("wss://gateway.p2p.works"));console.log(this.provider),this.provider.onopen=n=>console.log(n),this.provider.onmessage=({data:n})=>{if(n){const{type:r,name:o,payload:i}=JSON.parse(n)??{};if(r&&o!==this.name){const a=this.map.get(r);a&&this._events.next(new a(i))}}}}onOpen(n){this.provider.onopen=n}emit(n,r){const o={payload:r,name:this.name,type:n};this.provider.readyState===this.provider.OPEN&&this.provider.send(JSON.stringify(o))}}class ue extends RTCSessionDescription{constructor(t){super(t)}}class le extends RTCIceCandidate{constructor(t){super(t)}}const Fe=new Map;function Dt(e,t){Fe.set(e,t)}function jt(e){const t=Fe.get(e);if(!t)throw new Error(`O tipo ${e.name} não está registrado`);return new t}class K extends RTCSessionDescription{constructor(t){super(t)}}const Ut=e=>{const t=new ot(e),n=()=>t.getValue();return{value$:t.asObservable(),select:u=>t.asObservable().pipe(ce(s=>u(s)),se()),value:n,patch:u=>{t.next({...n(),...u})},update:(u,s)=>{t.next({...n(),[u]:s})},set:u=>t.next(u)}},Lt=["have-remote-offer","have-local-pranswer"],$t=e=>Lt.includes(e);function Ft(e,t=1){const n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return`rgba(${n},${r},${o},${t})`}const Mt=(e,{color:t,opacity:n}={color:"black",opacity:1})=>{const r=document.createElement("canvas"),o=new AudioContext,i=r.getContext("2d");i.fillStyle=Ft(t,n);const a=o.createMediaStreamSource(e),c=o.createAnalyser();a.connect(c);const u=c.frequencyBinCount,s=new Uint8Array(u);let f,d,l,p;const{width:g,height:y}=r,_=()=>{if(i&&e){i.clearRect(0,0,g,y),f=g;for(let w=0;w<f;w++)l=g/f,d=w*(l+2),p=-s[w]/1.6,i.fillRect(d,y,l,p)}};let O=-1;const E=()=>{O=requestAnimationFrame(E),c.getByteFrequencyData(s),_()};return{canvas:r,renderLoop:E,animationFrame:O,disable:()=>{e.getTracks().forEach(w=>w.enabled=!1),cancelAnimationFrame(O),o.suspend()}}},qt=async(e,t)=>{const n=await e.createAnswer(t);return await e.setLocalDescription(n),n},Me=()=>{const e=document.createElement("audio");return e.controls=!0,e.autoplay=!0,e},qe=async(e,t)=>{const n=await e.createOffer(t);return await e.setLocalDescription(n),n};function fe(...e){const t=n=>!!e.find(r=>n instanceof r);return n=>n.pipe(L(t))}function Vt(e=-3,t=3){return Math.random()*(t-e)+e}const Yt=e=>navigator.mediaDevices.getUserMedia(e||{audio:!0});function be(e,t,n,r){const o=t*e.sampleRate,i=(t-2*n)*e.sampleRate,a=o+i,c=e.createBuffer(1,a,e.sampleRate),u=c.getChannelData(0);for(let s=0;s<o;++s)r?u[s]=(o-s)/a:u[s]=s/o;for(let s=o;s<a;++s)u[s]=0;return c}function Qt(e,t,n){const r=t*e.sampleRate,o=(t-2*n)*e.sampleRate,i=r+o,a=e.createBuffer(1,i,e.sampleRate),c=a.getChannelData(0),u=n*e.sampleRate,s=u,f=r-u;for(let d=0;d<r;++d){let l;d<s?l=Math.sqrt(d/u):d>=f?l=Math.sqrt(1-(d-f)/u):l=1,c[d]=l}for(let d=r;d<i;++d)c[d]=0;return a}class Kt{constructor(t,n=.1,r=.05,o=.1){h(this,"input");h(this,"output");h(this,"shiftDownBuffer");h(this,"shiftUpBuffer");h(this,"mod1");h(this,"mod2");h(this,"mod1Gain");h(this,"mod2Gain");h(this,"mod3Gain");h(this,"mod4Gain");h(this,"modGain1");h(this,"modGain2");h(this,"fade1");h(this,"fade2");h(this,"mix1");h(this,"mix2");h(this,"delay1");h(this,"delay2");this.context=t,this.bufferTime=n,this.fadeTime=r,this.delayTime=o;const i=t.createGain(),a=t.createGain();this.input=i,this.output=a;const c=t.createBufferSource(),u=t.createBufferSource(),s=t.createBufferSource(),f=t.createBufferSource();this.shiftDownBuffer=be(t,n,r,!1),this.shiftUpBuffer=be(t,n,r,!0),c.buffer=this.shiftDownBuffer,u.buffer=this.shiftDownBuffer,s.buffer=this.shiftUpBuffer,f.buffer=this.shiftUpBuffer,c.loop=!0,u.loop=!0,s.loop=!0,f.loop=!0;const d=t.createGain(),l=t.createGain(),p=t.createGain();p.gain.value=0;const g=t.createGain();g.gain.value=0,c.connect(d),u.connect(l),s.connect(p),f.connect(g);const y=t.createGain(),_=t.createGain(),O=t.createDelay(),E=t.createDelay();d.connect(y),l.connect(_),p.connect(y),g.connect(_),y.connect(O.delayTime),_.connect(E.delayTime);const I=t.createBufferSource(),w=t.createBufferSource(),de=Qt(t,n,r);I.buffer=de,w.buffer=de,I.loop=!0,w.loop=!0;const k=t.createGain(),R=t.createGain();k.gain.value=0,R.gain.value=0,I.connect(k.gain),w.connect(R.gain),i.connect(O),i.connect(E),O.connect(k),E.connect(R),k.connect(a),R.connect(a);const F=t.currentTime+.05,J=F+n-r;c.start(F),u.start(J),s.start(F),f.start(J),I.start(F),w.start(J),this.mod1=c,this.mod2=u,this.mod1Gain=d,this.mod2Gain=l,this.mod3Gain=p,this.mod4Gain=g,this.modGain1=y,this.modGain2=_,this.fade1=I,this.fade2=w,this.mix1=k,this.mix2=R,this.delay1=O,this.delay2=E,this.setDelay(o)}setDelay(t){this.modGain1.gain.setTargetAtTime(.5*t,0,.01),this.modGain2.gain.setTargetAtTime(.5*t,0,.01)}setPitchOffset(t){t>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(this.delayTime*Math.abs(t))}}const Ht=e=>{const t=new AudioContext,n=t.createMediaStreamSource(e),r=t.createDelay();r.delayTime.value=0,n.connect(r);const o=new Kt(t);o.setPitchOffset(1.6),r.connect(o.input);const i=t.createMediaStreamDestination();o.output.connect(i);const a=document.createElement("input");return a.type="range",a.min="-3",a.max="3",a.value=String(Vt(-3,3)),a.oninput=()=>{o.setPitchOffset(a.valueAsNumber)},{input:a,destination:i}};Dt(x,Bt);const v=jt(x);v.on("offer",K);v.on("answer",ue);v.on("candidate",le);const X=new MediaStream,P=Me(),Z=Me(),m=new RTCPeerConnection;m.onicecandidate=e=>{if(e.candidate){const t=new le(e.candidate);v.emit("candidate",t),v.log("Enviei meus candidatos")}};const $=Ut({signaling:"closed",connection:"new",iceConnection:"closed",iceGathering:"new"});m.onsignalingstatechange=()=>{$.update("signaling",m.signalingState)};m.oniceconnectionstatechange=()=>{$.update("iceConnection",m.iceConnectionState)};m.onconnectionstatechange=()=>{$.update("connection",m.connectionState)};m.onicegatheringstatechange=()=>{$.update("iceGathering",m.iceGatheringState)};v.events$.pipe(fe(K),ce(async e=>(v.log("Recebi uma oferta"),await m.setRemoteDescription(e),v.log("Configurei uma descrição remota"),e))).subscribe(async e=>{if(await e,$t(m.signalingState)){v.log("Aceitei uma oferta");const t=await qt(m);v.log("Configurei uma descrição local"),v.emit("answer",new ue(t)),v.log("Enviei uma resposta")}});v.events$.pipe(fe(ue)).subscribe(async e=>{v.log("Recebi uma resposta"),m.setRemoteDescription(e),v.log("Configurei uma descrição remota")});v.events$.pipe(fe(le)).subscribe(async e=>{m.remoteDescription&&await m.addIceCandidate(e)});m.onnegotiationneeded=async()=>{v.log("Vamos negociar"),v.onOpen(async()=>{const e=await qe(m);v.emit("offer",new K(e)),v.log("Enviei uma oferta")})};const H=$.select(e=>e.connection),Jt=H.pipe(L(e=>e==="connected")),Wt=H.pipe(L(e=>e==="disconnected"),se((e,t)=>e!=="disconnected"&&t==="connecting")),zt=H.pipe(L(e=>e==="disconnected"),se((e,t)=>e!=="disconnected"&&t==="disconnected")),Xt=H.pipe(L(e=>e==="disconnected"));Jt.subscribe(()=>{document.body.appendChild(P),P.paused&&P.play()});Xt.subscribe(()=>{P.remove()});Tt([zt,Wt]).subscribe(async()=>{const e=await qe(m);v.emit("offer",new K(e)),v.log("Fomos desconectados, enviei uma nova oferta")});m.ontrack=({track:e})=>{if(e){X.addTrack(e),P.srcObject=X,P.autoplay=!0;const{canvas:t,renderLoop:n}=Mt(X);document.body.appendChild(t),n()}};Yt().then(e=>{Z.srcObject=e,Z.muted=!0,document.body.appendChild(Z);const{input:t,destination:n}=Ht(e),[r]=n.stream.getAudioTracks();m.addTrack(r),document.body.appendChild(t)});
